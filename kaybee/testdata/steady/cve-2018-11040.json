{
    "bugId": "CVE-2018-11040",
    "bugIdAlt": null,
    "maturity": "DRAFT",
    "origin": "PUBLIC",
    "description": "Spring Framework, versions 5.0.x prior to 5.0.7 and 4.3.x prior to 4.3.18 and older unsupported versions, allows web applications to enable cross-domain requests via JSONP (JSON with Padding) through AbstractJsonpResponseBodyAdvice for REST controllers and MappingJackson2JsonView for browser requests. Both are not enabled by default in Spring Framework nor Spring Boot, however, when MappingJackson2JsonView is configured in an application, JSONP support is automatically ready to use through the \"jsonp\" and \"callback\" JSONP parameters, enabling cross-domain requests.",
    "descriptionAlt": "JSONP enabled by default in MappingJackson2JsonView. Description: Spring Framework, versions 5.0.x prior to 5.0.7, versions 4.3.x prior to 4.3.18, and older unsupported versions, allows web applications to enable cross-domain requests via JSONP (JSON with Padding) through AbstractJsonpResponseBodyAdvice for REST controllers, and MappingJackson2JsonView for browser requests. Both are not enabled by default in Spring Framework nor Spring Boot. However when MappingJackson2JsonView is configured in an application, JSONP support is automatically ready to use through the jsonp and callback JSONP parameters, enabling cross-domain requests.\\nAllowing cross-domain requests from untrusted origins may expose user information to 3rd party browser scripts.\\nThis vulnerability applies to applications that:\\n - Explicitly configure MappingJackson2JsonView.\\n - And do not set the jsonpParameterNames property of MappingJackson2JsonView to an empty set.\\n - And expose sensitive user information over endpoints that can render content with JSONP.\\n\\nAffected Pivotal Products and Versions: Spring Framework 5.0 to 5.0.6. pring Framework 4.1 to 4.3.17. Mitigation: Users of affected versions should apply the following mitigation:\\n- 5.0.x users should upgrade to 5.0.7.\\n- 4.3.x users should upgrade to 4.3.18.\\n- Older versions should upgrade to a supported branch, or otherwise set MappingJacksonJsonViews jsonpParameterNames property to an empty set.\\n\\nApplications that do require JSONP support will need to explicitly configure the jsonpParameterNames property of MappingJacksonJsonView following the upgrade. It is recommended that applications switch to using CORS instead of JSONP to enable cross-domain requests. JSONP support in the Spring Framework is deprecated as of 5.0.7 and 4.3.18 and will be removed in 5.1.",
    "cvssScore": 5.9,
    "cvssVersion": "3.0",
    "cvssVector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
    "reference": [
        "https://jira.spring.io/browse/SPR-16798",
        "https://pivotal.io/security/cve-2018-11040"
    ],
    "constructChanges": [
        {
            "repo": "https://github.com/spring-projects/spring-framework/",
            "commit": "874859493bbda59739c38c7e52eb3625f247b93",
            "repoPath": "4.3.x:spring-web/src/main/java/org/springframework/http/converter/json/MappingJackson2HttpMessageConverter.java",
            "constructId": {
                "lang": "JAVA",
                "type": "PACK",
                "qname": "org.springframework.http.converter.json"
            },
            "committedAt": "2018-06-08T10:33:27.000+0000",
            "constructChangeType": "MOD"
        },
        {
            "repo": "https://github.com/spring-projects/spring-framework/",
            "commit": "874859493bbda59739c38c7e52eb3625f247b93",
            "repoPath": "4.3.x:spring-webmvc/src/main/java/org/springframework/web/servlet/mvc/method/annotation/AbstractJsonpResponseBodyAdvice.java",
            "constructId": {
                "lang": "JAVA",
                "type": "PACK",
                "qname": "org.springframework.web.servlet.mvc.method.annotation"
            },
            "committedAt": "2018-06-08T10:33:27.000+0000",
            "constructChangeType": "MOD"
        },
        {
            "repo": "https://github.com/spring-projects/spring-framework/",
            "commit": "874859493bbda59739c38c7e52eb3625f247b93",
            "repoPath": "4.3.x:spring-webmvc/src/test/java/org/springframework/web/servlet/view/json/MappingJackson2JsonViewTests.java",
            "constructId": {
                "lang": "JAVA",
                "type": "PACK",
                "qname": "org.springframework.web.servlet.view.json"
            },
            "committedAt": "2018-06-08T10:33:27.000+0000",
            "constructChangeType": "MOD"
        },
        {
            "repo": "https://github.com/spring-projects/spring-framework/",
            "commit": "874859493bbda59739c38c7e52eb3625f247b93",
            "repoPath": "4.3.x:spring-webmvc/src/test/java/org/springframework/web/servlet/view/json/MappingJackson2JsonViewTests.java",
            "constructId": {
                "lang": "JAVA",
                "type": "CLAS",
                "qname": "org.springframework.web.servlet.view.json.MappingJackson2JsonViewTests"
            },
            "committedAt": "2018-06-08T10:33:27.000+0000",
            "constructChangeType": "MOD"
        },
        {
            "repo": "https://github.com/spring-projects/spring-framework/",
            "commit": "874859493bbda59739c38c7e52eb3625f247b93",
            "repoPath": "4.3.x:spring-webmvc/src/test/java/org/springframework/web/servlet/view/json/MappingJackson2JsonViewTests.java",
            "constructId": {
                "lang": "JAVA",
                "type": "METH",
                "qname": "org.springframework.web.servlet.view.json.MappingJackson2JsonViewTests.renderWithJsonp()"
            },
            "committedAt": "2018-06-08T10:33:27.000+0000",
            "constructChangeType": "MOD",
            "buggyBody": "{\"ast\":[{\"Value\":\"renderWithJsonp\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"19\",\"End\":\"364\"}},\"EntityType\":\"METHOD\",\"C\":[{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"callback\\\", true);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"63\",\"End\":\"99\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"_callback\\\", true);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"103\",\"End\":\"140\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"_Call.bAcK\\\", true);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"144\",\"End\":\"182\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_.\\\", true);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"186\",\"End\":\"278\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"<script>\\\", false);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"283\",\"End\":\"320\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"!foo!bar\\\", false);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"324\",\"End\":\"361\"}},\"EntityType\":\"METHOD_INVOCATION\"}]}]}",
            "fixedBody": "{\"ast\":[{\"Value\":\"renderWithJsonp\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"19\",\"End\":\"757\"}},\"EntityType\":\"METHOD\",\"C\":[{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"callback\\\", false);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"63\",\"End\":\"100\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"_callback\\\", false);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"104\",\"End\":\"142\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"_Call.bAcK\\\", false);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"146\",\"End\":\"185\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_.\\\", false);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"189\",\"End\":\"282\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"<script>\\\", false);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"286\",\"End\":\"323\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"!foo!bar\\\", false);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"327\",\"End\":\"364\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"this.view.setJsonpParameterNames(new LinkedHashSet<String>(Arrays.asList(\\\"jsonp\\\")));\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"369\",\"End\":\"452\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"callback\\\", true);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"457\",\"End\":\"493\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"_callback\\\", true);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"497\",\"End\":\"534\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"_Call.bAcK\\\", true);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"538\",\"End\":\"576\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_.\\\", true);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"580\",\"End\":\"672\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"<script>\\\", false);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"676\",\"End\":\"713\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"!foo!bar\\\", false);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"717\",\"End\":\"754\"}},\"EntityType\":\"METHOD_INVOCATION\"}]}]}",
            "bodyChange": "{\"StructureEntity\":{\"UniqueName\":\"renderWithJsonp\",\"EntityType\":\"METHOD\",\"Modifiers\":\"0\",\"changes\":[{\"OperationType\":\"Insert\",\"changeType\":\"STATEMENT_INSERT\",\"InsertedEntity\":{\"UniqueName\":\"testJsonp(\\\"jsonp\\\", \\\"_Call.bAcK\\\", false);\",\"EntityType\":\"METHOD_INVOCATION\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"146\",\"End\":\"185\"}},\"ParentEntity\":{\"UniqueName\":\"renderWithJsonp\",\"EntityType\":\"METHOD\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"19\",\"End\":\"364\"}}},{\"OperationType\":\"Insert\",\"changeType\":\"STATEMENT_INSERT\",\"InsertedEntity\":{\"UniqueName\":\"testJsonp(\\\"jsonp\\\", \\\"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_.\\\", false);\",\"EntityType\":\"METHOD_INVOCATION\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"189\",\"End\":\"282\"}},\"ParentEntity\":{\"UniqueName\":\"renderWithJsonp\",\"EntityType\":\"METHOD\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"19\",\"End\":\"364\"}}},{\"OperationType\":\"Insert\",\"changeType\":\"STATEMENT_INSERT\",\"InsertedEntity\":{\"UniqueName\":\"testJsonp(\\\"jsonp\\\", \\\"callback\\\", false);\",\"EntityType\":\"METHOD_INVOCATION\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"63\",\"End\":\"100\"}},\"ParentEntity\":{\"UniqueName\":\"renderWithJsonp\",\"EntityType\":\"METHOD\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"19\",\"End\":\"364\"}}},{\"OperationType\":\"Insert\",\"changeType\":\"STATEMENT_INSERT\",\"InsertedEntity\":{\"UniqueName\":\"this.view.setJsonpParameterNames(new LinkedHashSet<String>(Arrays.asList(\\\"jsonp\\\")));\",\"EntityType\":\"METHOD_INVOCATION\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"369\",\"End\":\"452\"}},\"ParentEntity\":{\"UniqueName\":\"renderWithJsonp\",\"EntityType\":\"METHOD\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"19\",\"End\":\"364\"}}},{\"OperationType\":\"Insert\",\"changeType\":\"STATEMENT_INSERT\",\"InsertedEntity\":{\"UniqueName\":\"testJsonp(\\\"jsonp\\\", \\\"!foo!bar\\\", false);\",\"EntityType\":\"METHOD_INVOCATION\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"717\",\"End\":\"754\"}},\"ParentEntity\":{\"UniqueName\":\"renderWithJsonp\",\"EntityType\":\"METHOD\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"19\",\"End\":\"364\"}}},{\"OperationType\":\"Move\",\"changeType\":\"STATEMENT_ORDERING_CHANGE\",\"OldParentEntity\":{\"UniqueName\":\"renderWithJsonp\",\"EntityType\":\"METHOD\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"19\",\"End\":\"364\"}},\"MovedEntity\":{\"UniqueName\":\"testJsonp(\\\"jsonp\\\", \\\"<script>\\\", false);\",\"EntityType\":\"METHOD_INVOCATION\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"283\",\"End\":\"320\"}},\"NewParentEntity\":{\"UniqueName\":\"renderWithJsonp\",\"EntityType\":\"METHOD\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"19\",\"End\":\"364\"}},\"NewEntity\":{\"UniqueName\":\"testJsonp(\\\"jsonp\\\", \\\"<script>\\\", false);\",\"EntityType\":\"METHOD_INVOCATION\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"286\",\"End\":\"323\"}}},{\"OperationType\":\"Insert\",\"changeType\":\"STATEMENT_INSERT\",\"InsertedEntity\":{\"UniqueName\":\"testJsonp(\\\"jsonp\\\", \\\"_callback\\\", false);\",\"EntityType\":\"METHOD_INVOCATION\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"104\",\"End\":\"142\"}},\"ParentEntity\":{\"UniqueName\":\"renderWithJsonp\",\"EntityType\":\"METHOD\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"19\",\"End\":\"364\"}}},{\"OperationType\":\"Insert\",\"changeType\":\"STATEMENT_INSERT\",\"InsertedEntity\":{\"UniqueName\":\"testJsonp(\\\"jsonp\\\", \\\"<script>\\\", false);\",\"EntityType\":\"METHOD_INVOCATION\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"676\",\"End\":\"713\"}},\"ParentEntity\":{\"UniqueName\":\"renderWithJsonp\",\"EntityType\":\"METHOD\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"19\",\"End\":\"364\"}}},{\"OperationType\":\"Move\",\"changeType\":\"STATEMENT_ORDERING_CHANGE\",\"OldParentEntity\":{\"UniqueName\":\"renderWithJsonp\",\"EntityType\":\"METHOD\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"19\",\"End\":\"364\"}},\"MovedEntity\":{\"UniqueName\":\"testJsonp(\\\"jsonp\\\", \\\"!foo!bar\\\", false);\",\"EntityType\":\"METHOD_INVOCATION\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"324\",\"End\":\"361\"}},\"NewParentEntity\":{\"UniqueName\":\"renderWithJsonp\",\"EntityType\":\"METHOD\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"19\",\"End\":\"364\"}},\"NewEntity\":{\"UniqueName\":\"testJsonp(\\\"jsonp\\\", \\\"!foo!bar\\\", false);\",\"EntityType\":\"METHOD_INVOCATION\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"327\",\"End\":\"364\"}}}]}}"
        },
        {
            "repo": "https://github.com/spring-projects/spring-framework/",
            "commit": "874859493bbda59739c38c7e52eb3625f247b93",
            "repoPath": "4.3.x:spring-websocket/src/main/java/org/springframework/web/socket/sockjs/transport/TransportType.java",
            "constructId": {
                "lang": "JAVA",
                "type": "PACK",
                "qname": "org.springframework.web.socket.sockjs.transport"
            },
            "committedAt": "2018-06-08T10:33:27.000+0000",
            "constructChangeType": "MOD"
        },
        {
            "repo": "https://github.com/spring-projects/spring-framework/",
            "commit": "874859493bbda59739c38c7e52eb3625f247b93",
            "repoPath": "4.3.x:spring-websocket/src/main/java/org/springframework/web/socket/sockjs/transport/TransportType.java",
            "constructId": {
                "lang": "JAVA",
                "type": "ENUM",
                "qname": "org.springframework.web.socket.sockjs.transport.TransportType"
            },
            "committedAt": "2018-06-08T10:33:27.000+0000",
            "constructChangeType": "MOD"
        },
        {
            "repo": "https://github.com/spring-projects/spring-framework/",
            "commit": "874859493bbda59739c38c7e52eb3625f247b93",
            "repoPath": "4.3.x:spring-websocket/src/main/java/org/springframework/web/socket/sockjs/transport/handler/DefaultSockJsService.java",
            "constructId": {
                "lang": "JAVA",
                "type": "PACK",
                "qname": "org.springframework.web.socket.sockjs.transport.handler"
            },
            "committedAt": "2018-06-08T10:33:27.000+0000",
            "constructChangeType": "MOD"
        },
        {
            "repo": "https://github.com/spring-projects/spring-framework/",
            "commit": "b80c13b722bb207ddf43f53a007ee3ddc1dd2e2",
            "repoPath": "5.0.x:spring-web/src/main/java/org/springframework/http/converter/json/MappingJackson2HttpMessageConverter.java",
            "constructId": {
                "lang": "JAVA",
                "type": "PACK",
                "qname": "org.springframework.http.converter.json"
            },
            "committedAt": "2018-06-08T10:31:40.000+0000",
            "constructChangeType": "MOD"
        },
        {
            "repo": "https://github.com/spring-projects/spring-framework/",
            "commit": "b80c13b722bb207ddf43f53a007ee3ddc1dd2e2",
            "repoPath": "5.0.x:spring-webmvc/src/main/java/org/springframework/web/servlet/mvc/method/annotation/AbstractJsonpResponseBodyAdvice.java",
            "constructId": {
                "lang": "JAVA",
                "type": "PACK",
                "qname": "org.springframework.web.servlet.mvc.method.annotation"
            },
            "committedAt": "2018-06-08T10:31:40.000+0000",
            "constructChangeType": "MOD"
        },
        {
            "repo": "https://github.com/spring-projects/spring-framework/",
            "commit": "b80c13b722bb207ddf43f53a007ee3ddc1dd2e2",
            "repoPath": "5.0.x:spring-webmvc/src/test/java/org/springframework/web/servlet/view/json/MappingJackson2JsonViewTests.java",
            "constructId": {
                "lang": "JAVA",
                "type": "PACK",
                "qname": "org.springframework.web.servlet.view.json"
            },
            "committedAt": "2018-06-08T10:31:40.000+0000",
            "constructChangeType": "MOD"
        },
        {
            "repo": "https://github.com/spring-projects/spring-framework/",
            "commit": "b80c13b722bb207ddf43f53a007ee3ddc1dd2e2",
            "repoPath": "5.0.x:spring-webmvc/src/test/java/org/springframework/web/servlet/view/json/MappingJackson2JsonViewTests.java",
            "constructId": {
                "lang": "JAVA",
                "type": "CLAS",
                "qname": "org.springframework.web.servlet.view.json.MappingJackson2JsonViewTests"
            },
            "committedAt": "2018-06-08T10:31:40.000+0000",
            "constructChangeType": "MOD"
        },
        {
            "repo": "https://github.com/spring-projects/spring-framework/",
            "commit": "b80c13b722bb207ddf43f53a007ee3ddc1dd2e2",
            "repoPath": "5.0.x:spring-webmvc/src/test/java/org/springframework/web/servlet/view/json/MappingJackson2JsonViewTests.java",
            "constructId": {
                "lang": "JAVA",
                "type": "METH",
                "qname": "org.springframework.web.servlet.view.json.MappingJackson2JsonViewTests.renderWithJsonp()"
            },
            "committedAt": "2018-06-08T10:31:40.000+0000",
            "constructChangeType": "MOD",
            "buggyBody": "{\"ast\":[{\"Value\":\"renderWithJsonp\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"19\",\"End\":\"364\"}},\"EntityType\":\"METHOD\",\"C\":[{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"callback\\\", true);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"63\",\"End\":\"99\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"_callback\\\", true);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"103\",\"End\":\"140\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"_Call.bAcK\\\", true);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"144\",\"End\":\"182\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_.\\\", true);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"186\",\"End\":\"278\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"<script>\\\", false);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"283\",\"End\":\"320\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"!foo!bar\\\", false);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"324\",\"End\":\"361\"}},\"EntityType\":\"METHOD_INVOCATION\"}]}]}",
            "fixedBody": "{\"ast\":[{\"Value\":\"renderWithJsonp\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"19\",\"End\":\"751\"}},\"EntityType\":\"METHOD\",\"C\":[{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"callback\\\", false);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"63\",\"End\":\"100\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"_callback\\\", false);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"104\",\"End\":\"142\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"_Call.bAcK\\\", false);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"146\",\"End\":\"185\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_.\\\", false);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"189\",\"End\":\"282\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"<script>\\\", false);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"286\",\"End\":\"323\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"!foo!bar\\\", false);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"327\",\"End\":\"364\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"this.view.setJsonpParameterNames(new LinkedHashSet<>(Arrays.asList(\\\"jsonp\\\")));\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"369\",\"End\":\"446\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"callback\\\", true);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"451\",\"End\":\"487\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"_callback\\\", true);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"491\",\"End\":\"528\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"_Call.bAcK\\\", true);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"532\",\"End\":\"570\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_.\\\", true);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"574\",\"End\":\"666\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"<script>\\\", false);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"670\",\"End\":\"707\"}},\"EntityType\":\"METHOD_INVOCATION\"},{\"Value\":\"testJsonp(\\\"jsonp\\\", \\\"!foo!bar\\\", false);\",\"SourceCodeEntity\":{\"Modifiers\":\"0\",\"SourceRange\":{\"Start\":\"711\",\"End\":\"748\"}},\"EntityType\":\"METHOD_INVOCATION\"}]}]}",
            "bodyChange": "{\"StructureEntity\":{\"UniqueName\":\"renderWithJsonp\",\"EntityType\":\"METHOD\",\"Modifiers\":\"0\",\"changes\":[{\"OperationType\":\"Insert\",\"changeType\":\"STATEMENT_INSERT\",\"InsertedEntity\":{\"UniqueName\":\"testJsonp(\\\"jsonp\\\", \\\"_Call.bAcK\\\", false);\",\"EntityType\":\"METHOD_INVOCATION\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"146\",\"End\":\"185\"}},\"ParentEntity\":{\"UniqueName\":\"renderWithJsonp\",\"EntityType\":\"METHOD\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"19\",\"End\":\"364\"}}},{\"OperationType\":\"Insert\",\"changeType\":\"STATEMENT_INSERT\",\"InsertedEntity\":{\"UniqueName\":\"testJsonp(\\\"jsonp\\\", \\\"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_.\\\", false);\",\"EntityType\":\"METHOD_INVOCATION\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"189\",\"End\":\"282\"}},\"ParentEntity\":{\"UniqueName\":\"renderWithJsonp\",\"EntityType\":\"METHOD\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"19\",\"End\":\"364\"}}},{\"OperationType\":\"Insert\",\"changeType\":\"STATEMENT_INSERT\",\"InsertedEntity\":{\"UniqueName\":\"this.view.setJsonpParameterNames(new LinkedHashSet<>(Arrays.asList(\\\"jsonp\\\")));\",\"EntityType\":\"METHOD_INVOCATION\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"369\",\"End\":\"446\"}},\"ParentEntity\":{\"UniqueName\":\"renderWithJsonp\",\"EntityType\":\"METHOD\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"19\",\"End\":\"364\"}}},{\"OperationType\":\"Insert\",\"changeType\":\"STATEMENT_INSERT\",\"InsertedEntity\":{\"UniqueName\":\"testJsonp(\\\"jsonp\\\", \\\"callback\\\", false);\",\"EntityType\":\"METHOD_INVOCATION\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"63\",\"End\":\"100\"}},\"ParentEntity\":{\"UniqueName\":\"renderWithJsonp\",\"EntityType\":\"METHOD\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"19\",\"End\":\"364\"}}},{\"OperationType\":\"Insert\",\"changeType\":\"STATEMENT_INSERT\",\"InsertedEntity\":{\"UniqueName\":\"testJsonp(\\\"jsonp\\\", \\\"!foo!bar\\\", false);\",\"EntityType\":\"METHOD_INVOCATION\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"711\",\"End\":\"748\"}},\"ParentEntity\":{\"UniqueName\":\"renderWithJsonp\",\"EntityType\":\"METHOD\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"19\",\"End\":\"364\"}}},{\"OperationType\":\"Move\",\"changeType\":\"STATEMENT_ORDERING_CHANGE\",\"OldParentEntity\":{\"UniqueName\":\"renderWithJsonp\",\"EntityType\":\"METHOD\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"19\",\"End\":\"364\"}},\"MovedEntity\":{\"UniqueName\":\"testJsonp(\\\"jsonp\\\", \\\"<script>\\\", false);\",\"EntityType\":\"METHOD_INVOCATION\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"283\",\"End\":\"320\"}},\"NewParentEntity\":{\"UniqueName\":\"renderWithJsonp\",\"EntityType\":\"METHOD\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"19\",\"End\":\"364\"}},\"NewEntity\":{\"UniqueName\":\"testJsonp(\\\"jsonp\\\", \\\"<script>\\\", false);\",\"EntityType\":\"METHOD_INVOCATION\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"286\",\"End\":\"323\"}}},{\"OperationType\":\"Insert\",\"changeType\":\"STATEMENT_INSERT\",\"InsertedEntity\":{\"UniqueName\":\"testJsonp(\\\"jsonp\\\", \\\"_callback\\\", false);\",\"EntityType\":\"METHOD_INVOCATION\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"104\",\"End\":\"142\"}},\"ParentEntity\":{\"UniqueName\":\"renderWithJsonp\",\"EntityType\":\"METHOD\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"19\",\"End\":\"364\"}}},{\"OperationType\":\"Insert\",\"changeType\":\"STATEMENT_INSERT\",\"InsertedEntity\":{\"UniqueName\":\"testJsonp(\\\"jsonp\\\", \\\"<script>\\\", false);\",\"EntityType\":\"METHOD_INVOCATION\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"670\",\"End\":\"707\"}},\"ParentEntity\":{\"UniqueName\":\"renderWithJsonp\",\"EntityType\":\"METHOD\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"19\",\"End\":\"364\"}}},{\"OperationType\":\"Move\",\"changeType\":\"STATEMENT_ORDERING_CHANGE\",\"OldParentEntity\":{\"UniqueName\":\"renderWithJsonp\",\"EntityType\":\"METHOD\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"19\",\"End\":\"364\"}},\"MovedEntity\":{\"UniqueName\":\"testJsonp(\\\"jsonp\\\", \\\"!foo!bar\\\", false);\",\"EntityType\":\"METHOD_INVOCATION\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"324\",\"End\":\"361\"}},\"NewParentEntity\":{\"UniqueName\":\"renderWithJsonp\",\"EntityType\":\"METHOD\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"19\",\"End\":\"364\"}},\"NewEntity\":{\"UniqueName\":\"testJsonp(\\\"jsonp\\\", \\\"!foo!bar\\\", false);\",\"EntityType\":\"METHOD_INVOCATION\",\"Modifiers\":\"0\",\"SourceCodeRange\":{\"Start\":\"327\",\"End\":\"364\"}}}]}}"
        },
        {
            "repo": "https://github.com/spring-projects/spring-framework/",
            "commit": "b80c13b722bb207ddf43f53a007ee3ddc1dd2e2",
            "repoPath": "5.0.x:spring-websocket/src/main/java/org/springframework/web/socket/sockjs/transport/TransportType.java",
            "constructId": {
                "lang": "JAVA",
                "type": "PACK",
                "qname": "org.springframework.web.socket.sockjs.transport"
            },
            "committedAt": "2018-06-08T10:31:40.000+0000",
            "constructChangeType": "MOD"
        },
        {
            "repo": "https://github.com/spring-projects/spring-framework/",
            "commit": "b80c13b722bb207ddf43f53a007ee3ddc1dd2e2",
            "repoPath": "5.0.x:spring-websocket/src/main/java/org/springframework/web/socket/sockjs/transport/TransportType.java",
            "constructId": {
                "lang": "JAVA",
                "type": "ENUM",
                "qname": "org.springframework.web.socket.sockjs.transport.TransportType"
            },
            "committedAt": "2018-06-08T10:31:40.000+0000",
            "constructChangeType": "MOD"
        },
        {
            "repo": "https://github.com/spring-projects/spring-framework/",
            "commit": "b80c13b722bb207ddf43f53a007ee3ddc1dd2e2",
            "repoPath": "5.0.x:spring-websocket/src/main/java/org/springframework/web/socket/sockjs/transport/handler/DefaultSockJsService.java",
            "constructId": {
                "lang": "JAVA",
                "type": "PACK",
                "qname": "org.springframework.web.socket.sockjs.transport.handler"
            },
            "committedAt": "2018-06-08T10:31:40.000+0000",
            "constructChangeType": "MOD"
        }
    ],
    "createdAt": "2018-06-19T10:16:51.999+0000",
    "createdBy": null,
    "modifiedAt": "2019-03-15T14:36:03.636+0000",
    "modifiedBy": null,
    "cvssDisplayString": "5.9 (v3.0)",
    "countConstructChanges": 16,
    "countAffLibIds": {
        "ratios": null,
        "percentages": null,
        "counters": [
            {
                "name": "MANUAL",
                "count": 89
            }
        ]
    }
}
